<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: cdc_handshake Pages: 1 -->
<svg width="915pt" height="814pt"
 viewBox="0.00 0.00 915.00 813.87" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 809.87)">
<title>cdc_handshake</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-809.87 911,-809.87 911,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_apb</title>
<polygon fill="lightcyan" stroke="black" points="8,-421.5 8,-797.87 305,-797.87 305,-421.5 8,-421.5"/>
<text text-anchor="middle" x="156.5" y="-782.67" font-family="Times,serif" font-size="14.00">APB Clock Domain (pclk)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_hpet</title>
<polygon fill="lightyellow" stroke="black" points="313,-8 313,-497.5 548,-497.5 548,-8 313,-8"/>
<text text-anchor="middle" x="430.5" y="-482.3" font-family="Times,serif" font-size="14.00">HPET Clock Domain (hpet_clk)</text>
</g>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<ellipse fill="lightgreen" stroke="black" cx="214" cy="-740" rx="83.38" ry="26.74"/>
<text text-anchor="middle" x="214" y="-743.8" font-family="Arial" font-size="14.00">APB Transaction</text>
<text text-anchor="middle" x="214" y="-728.8" font-family="Arial" font-size="14.00">Begins</text>
</g>
<!-- apb_request -->
<g id="node2" class="node">
<title>apb_request</title>
<path fill="lightblue" stroke="black" d="M285,-646.5C285,-646.5 193,-646.5 193,-646.5 187,-646.5 181,-640.5 181,-634.5 181,-634.5 181,-620.5 181,-620.5 181,-614.5 187,-608.5 193,-608.5 193,-608.5 285,-608.5 285,-608.5 291,-608.5 297,-614.5 297,-620.5 297,-620.5 297,-634.5 297,-634.5 297,-640.5 291,-646.5 285,-646.5"/>
<text text-anchor="middle" x="239" y="-631.3" font-family="Arial" font-size="14.00">APB Slave CDC</text>
<text text-anchor="middle" x="239" y="-616.3" font-family="Arial" font-size="14.00">Asserts Request</text>
</g>
<!-- start&#45;&gt;apb_request -->
<g id="edge1" class="edge">
<title>start&#45;&gt;apb_request</title>
<path fill="none" stroke="black" d="M219.86,-713.09C223.69,-696.19 228.68,-674.12 232.61,-656.76"/>
<polygon fill="black" stroke="black" points="236.1,-657.18 234.89,-646.65 229.27,-655.64 236.1,-657.18"/>
</g>
<!-- apb_wait -->
<g id="node3" class="node">
<title>apb_wait</title>
<path fill="lightblue" stroke="black" d="M640.5,-466.5C640.5,-466.5 567.5,-466.5 567.5,-466.5 561.5,-466.5 555.5,-460.5 555.5,-454.5 555.5,-454.5 555.5,-440.5 555.5,-440.5 555.5,-434.5 561.5,-428.5 567.5,-428.5 567.5,-428.5 640.5,-428.5 640.5,-428.5 646.5,-428.5 652.5,-434.5 652.5,-440.5 652.5,-440.5 652.5,-454.5 652.5,-454.5 652.5,-460.5 646.5,-466.5 640.5,-466.5"/>
<text text-anchor="middle" x="604" y="-451.3" font-family="Arial" font-size="14.00">Wait for</text>
<text text-anchor="middle" x="604" y="-436.3" font-family="Arial" font-size="14.00">Acknowledge</text>
</g>
<!-- apb_request&#45;&gt;apb_wait -->
<g id="edge2" class="edge">
<title>apb_request&#45;&gt;apb_wait</title>
<path fill="none" stroke="black" d="M297.17,-626.3C365.17,-623.17 477.81,-608.6 552,-550 575.41,-531.51 589.28,-499.61 596.73,-476.5"/>
<polygon fill="black" stroke="black" points="600.09,-477.48 599.62,-466.89 593.39,-475.46 600.09,-477.48"/>
</g>
<!-- hpet_idle -->
<g id="node7" class="node">
<title>hpet_idle</title>
<path fill="lightblue" stroke="black" d="M439,-466.5C439,-466.5 333,-466.5 333,-466.5 327,-466.5 321,-460.5 321,-454.5 321,-454.5 321,-440.5 321,-440.5 321,-434.5 327,-428.5 333,-428.5 333,-428.5 439,-428.5 439,-428.5 445,-428.5 451,-434.5 451,-440.5 451,-440.5 451,-454.5 451,-454.5 451,-460.5 445,-466.5 439,-466.5"/>
<text text-anchor="middle" x="386" y="-451.3" font-family="Arial" font-size="14.00">HPET Idle</text>
<text text-anchor="middle" x="386" y="-436.3" font-family="Arial" font-size="14.00">Waiting for request</text>
</g>
<!-- apb_request&#45;&gt;hpet_idle -->
<g id="edge11" class="edge">
<title>apb_request&#45;&gt;hpet_idle</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M256.46,-608.38C270.93,-593.14 291.82,-570.6 309,-550 329.57,-525.33 351.59,-495.98 366.79,-475.2"/>
<polygon fill="blue" stroke="blue" points="369.8,-477 372.86,-466.86 364.14,-472.88 369.8,-477"/>
<text text-anchor="middle" x="324" y="-571.8" font-family="Arial" font-size="14.00">request →</text>
</g>
<!-- apb_sync_ack -->
<g id="node4" class="node">
<title>apb_sync_ack</title>
<path fill="lightblue" stroke="black" d="M100.5,-766.5C100.5,-766.5 27.5,-766.5 27.5,-766.5 21.5,-766.5 15.5,-760.5 15.5,-754.5 15.5,-754.5 15.5,-725.5 15.5,-725.5 15.5,-719.5 21.5,-713.5 27.5,-713.5 27.5,-713.5 100.5,-713.5 100.5,-713.5 106.5,-713.5 112.5,-719.5 112.5,-725.5 112.5,-725.5 112.5,-754.5 112.5,-754.5 112.5,-760.5 106.5,-766.5 100.5,-766.5"/>
<text text-anchor="middle" x="64" y="-751.3" font-family="Arial" font-size="14.00">Synchronize</text>
<text text-anchor="middle" x="64" y="-736.3" font-family="Arial" font-size="14.00">Acknowledge</text>
<text text-anchor="middle" x="64" y="-721.3" font-family="Arial" font-size="14.00">(2&#45;3 cycles)</text>
</g>
<!-- apb_wait&#45;&gt;apb_sync_ack -->
<g id="edge3" class="edge">
<title>apb_wait&#45;&gt;apb_sync_ack</title>
<path fill="none" stroke="black" d="M598.84,-466.8C589.45,-496.46 566.59,-554.59 525,-583 440.51,-640.71 404.99,-628.09 306,-654 225.3,-675.12 197.3,-655.1 122,-691 113.42,-695.09 105.04,-700.73 97.43,-706.7"/>
<polygon fill="black" stroke="black" points="94.98,-704.19 89.51,-713.27 99.44,-709.58 94.98,-704.19"/>
</g>
<!-- apb_complete -->
<g id="node5" class="node">
<title>apb_complete</title>
<path fill="lightblue" stroke="black" d="M122,-654C122,-654 28,-654 28,-654 22,-654 16,-648 16,-642 16,-642 16,-613 16,-613 16,-607 22,-601 28,-601 28,-601 122,-601 122,-601 128,-601 134,-607 134,-613 134,-613 134,-642 134,-642 134,-648 128,-654 122,-654"/>
<text text-anchor="middle" x="75" y="-638.8" font-family="Arial" font-size="14.00">APB Transaction</text>
<text text-anchor="middle" x="75" y="-623.8" font-family="Arial" font-size="14.00">Completes</text>
<text text-anchor="middle" x="75" y="-608.8" font-family="Arial" font-size="14.00">pready asserted</text>
</g>
<!-- apb_sync_ack&#45;&gt;apb_complete -->
<g id="edge4" class="edge">
<title>apb_sync_ack&#45;&gt;apb_complete</title>
<path fill="none" stroke="black" d="M66.55,-713.37C68,-698.83 69.83,-680.41 71.42,-664.44"/>
<polygon fill="black" stroke="black" points="74.92,-664.67 72.42,-654.37 67.95,-663.98 74.92,-664.67"/>
</g>
<!-- apb_end -->
<g id="node6" class="node">
<title>apb_end</title>
<ellipse fill="lightgreen" stroke="black" cx="75" cy="-447.5" rx="51.99" ry="18"/>
<text text-anchor="middle" x="75" y="-443.8" font-family="Arial" font-size="14.00">APB Done</text>
</g>
<!-- apb_complete&#45;&gt;apb_end -->
<g id="edge5" class="edge">
<title>apb_complete&#45;&gt;apb_end</title>
<path fill="none" stroke="black" d="M75,-601C75,-567.86 75,-510.22 75,-476.09"/>
<polygon fill="black" stroke="black" points="78.5,-475.9 75,-465.9 71.5,-475.9 78.5,-475.9"/>
</g>
<!-- hpet_sync_req -->
<g id="node8" class="node">
<title>hpet_sync_req</title>
<path fill="lightblue" stroke="black" d="M527.5,-308C527.5,-308 406.5,-308 406.5,-308 400.5,-308 394.5,-302 394.5,-296 394.5,-296 394.5,-282 394.5,-282 394.5,-276 400.5,-270 406.5,-270 406.5,-270 527.5,-270 527.5,-270 533.5,-270 539.5,-276 539.5,-282 539.5,-282 539.5,-296 539.5,-296 539.5,-302 533.5,-308 527.5,-308"/>
<text text-anchor="middle" x="467" y="-292.8" font-family="Arial" font-size="14.00">Synchronize Request</text>
<text text-anchor="middle" x="467" y="-277.8" font-family="Arial" font-size="14.00">(2&#45;3 cycles)</text>
</g>
<!-- hpet_idle&#45;&gt;hpet_sync_req -->
<g id="edge6" class="edge">
<title>hpet_idle&#45;&gt;hpet_sync_req</title>
<path fill="none" stroke="black" d="M395.45,-428.24C409.59,-400.91 436.37,-349.19 452.85,-317.34"/>
<polygon fill="black" stroke="black" points="456.12,-318.63 457.61,-308.14 449.9,-315.41 456.12,-318.63"/>
</g>
<!-- hpet_execute -->
<g id="node9" class="node">
<title>hpet_execute</title>
<path fill="lightblue" stroke="black" d="M514.5,-219C514.5,-219 419.5,-219 419.5,-219 413.5,-219 407.5,-213 407.5,-207 407.5,-207 407.5,-178 407.5,-178 407.5,-172 413.5,-166 419.5,-166 419.5,-166 514.5,-166 514.5,-166 520.5,-166 526.5,-172 526.5,-178 526.5,-178 526.5,-207 526.5,-207 526.5,-213 520.5,-219 514.5,-219"/>
<text text-anchor="middle" x="467" y="-203.8" font-family="Arial" font-size="14.00">Execute Register</text>
<text text-anchor="middle" x="467" y="-188.8" font-family="Arial" font-size="14.00">Access</text>
<text text-anchor="middle" x="467" y="-173.8" font-family="Arial" font-size="14.00">(read/write)</text>
</g>
<!-- hpet_sync_req&#45;&gt;hpet_execute -->
<g id="edge7" class="edge">
<title>hpet_sync_req&#45;&gt;hpet_execute</title>
<path fill="none" stroke="black" d="M467,-269.78C467,-258.33 467,-243.16 467,-229.36"/>
<polygon fill="black" stroke="black" points="470.5,-229.17 467,-219.17 463.5,-229.17 470.5,-229.17"/>
</g>
<!-- hpet_assert_ack -->
<g id="node10" class="node">
<title>hpet_assert_ack</title>
<path fill="lightblue" stroke="black" d="M503.5,-129C503.5,-129 430.5,-129 430.5,-129 424.5,-129 418.5,-123 418.5,-117 418.5,-117 418.5,-103 418.5,-103 418.5,-97 424.5,-91 430.5,-91 430.5,-91 503.5,-91 503.5,-91 509.5,-91 515.5,-97 515.5,-103 515.5,-103 515.5,-117 515.5,-117 515.5,-123 509.5,-129 503.5,-129"/>
<text text-anchor="middle" x="467" y="-113.8" font-family="Arial" font-size="14.00">Assert</text>
<text text-anchor="middle" x="467" y="-98.8" font-family="Arial" font-size="14.00">Acknowledge</text>
</g>
<!-- hpet_execute&#45;&gt;hpet_assert_ack -->
<g id="edge8" class="edge">
<title>hpet_execute&#45;&gt;hpet_assert_ack</title>
<path fill="none" stroke="black" d="M467,-165.59C467,-157.31 467,-148.11 467,-139.65"/>
<polygon fill="black" stroke="black" points="470.5,-139.47 467,-129.47 463.5,-139.47 470.5,-139.47"/>
</g>
<!-- hpet_assert_ack&#45;&gt;apb_wait -->
<g id="edge12" class="edge">
<title>hpet_assert_ack&#45;&gt;apb_wait</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M498.12,-129.16C511.64,-138.54 526.53,-151.15 536,-166 587.81,-247.22 600.15,-364.65 603.09,-418.09"/>
<polygon fill="red" stroke="red" points="599.6,-418.37 603.57,-428.2 606.59,-418.04 599.6,-418.37"/>
<text text-anchor="middle" x="594" y="-240.8" font-family="Arial" font-size="14.00">← ack</text>
</g>
<!-- hpet_wait_clear -->
<g id="node11" class="node">
<title>hpet_wait_clear</title>
<path fill="lightblue" stroke="black" d="M448.5,-54C448.5,-54 355.5,-54 355.5,-54 349.5,-54 343.5,-48 343.5,-42 343.5,-42 343.5,-28 343.5,-28 343.5,-22 349.5,-16 355.5,-16 355.5,-16 448.5,-16 448.5,-16 454.5,-16 460.5,-22 460.5,-28 460.5,-28 460.5,-42 460.5,-42 460.5,-48 454.5,-54 448.5,-54"/>
<text text-anchor="middle" x="402" y="-38.8" font-family="Arial" font-size="14.00">Wait for Request</text>
<text text-anchor="middle" x="402" y="-23.8" font-family="Arial" font-size="14.00">to Clear</text>
</g>
<!-- hpet_assert_ack&#45;&gt;hpet_wait_clear -->
<g id="edge9" class="edge">
<title>hpet_assert_ack&#45;&gt;hpet_wait_clear</title>
<path fill="none" stroke="black" d="M450.93,-90.96C443.04,-82.09 433.4,-71.26 424.76,-61.56"/>
<polygon fill="black" stroke="black" points="427.37,-59.23 418.11,-54.09 422.14,-63.89 427.37,-59.23"/>
</g>
<!-- hpet_wait_clear&#45;&gt;hpet_idle -->
<g id="edge10" class="edge">
<title>hpet_wait_clear&#45;&gt;hpet_idle</title>
<path fill="none" stroke="black" d="M391.17,-54.22C383.66,-68.59 375,-89.41 375,-109 375,-290 375,-290 375,-290 375,-334.83 379.55,-386.71 382.79,-418.04"/>
<polygon fill="black" stroke="black" points="379.34,-418.65 383.88,-428.22 386.3,-417.9 379.34,-418.65"/>
</g>
<!-- timing -->
<g id="node12" class="node">
<title>timing</title>
<polygon fill="white" stroke="black" points="907,-550 671,-550 671,-345 907,-345 907,-550"/>
<text text-anchor="middle" x="789" y="-534.8" font-family="Arial" font-size="14.00">Timing Sequence:</text>
<text text-anchor="middle" x="789" y="-503.8" font-family="Arial" font-size="14.00">1. APB: request ↑</text>
<text text-anchor="middle" x="789" y="-488.8" font-family="Arial" font-size="14.00">2. HPET: sync request (2&#45;3 hpet_clk)</text>
<text text-anchor="middle" x="789" y="-473.8" font-family="Arial" font-size="14.00">3. HPET: execute access</text>
<text text-anchor="middle" x="789" y="-458.8" font-family="Arial" font-size="14.00">4. HPET: ack ↑</text>
<text text-anchor="middle" x="789" y="-443.8" font-family="Arial" font-size="14.00">5. APB: sync ack (2&#45;3 pclk)</text>
<text text-anchor="middle" x="789" y="-428.8" font-family="Arial" font-size="14.00">6. APB: complete transaction</text>
<text text-anchor="middle" x="789" y="-413.8" font-family="Arial" font-size="14.00">7. APB: request ↓</text>
<text text-anchor="middle" x="789" y="-398.8" font-family="Arial" font-size="14.00">8. HPET: sync clear (2&#45;3 hpet_clk)</text>
<text text-anchor="middle" x="789" y="-383.8" font-family="Arial" font-size="14.00">9. HPET: ack ↓</text>
<text text-anchor="middle" x="789" y="-352.8" font-family="Arial" font-size="14.00">Total latency: 4&#45;6 APB cycles</text>
</g>
<!-- note1 -->
<g id="node13" class="node">
<title>note1</title>
<polygon fill="yellow" stroke="black" points="457,-789 315,-789 315,-691 463,-691 463,-783 457,-789"/>
<polyline fill="none" stroke="black" points="457,-789 457,-783 "/>
<polyline fill="none" stroke="black" points="463,-783 457,-783 "/>
<text text-anchor="middle" x="389" y="-773.8" font-family="Arial" font-size="14.00">CDC Required When:</text>
<text text-anchor="middle" x="389" y="-758.8" font-family="Arial" font-size="14.00">• pclk and hpet_clk</text>
<text text-anchor="middle" x="389" y="-743.8" font-family="Arial" font-size="14.00"> &#160;are asynchronous</text>
<text text-anchor="middle" x="389" y="-728.8" font-family="Arial" font-size="14.00">• Frequency ratio</text>
<text text-anchor="middle" x="389" y="-713.8" font-family="Arial" font-size="14.00"> &#160;is not constant</text>
<text text-anchor="middle" x="389" y="-698.8" font-family="Arial" font-size="14.00">• CDC_ENABLE = 1</text>
</g>
<!-- note2 -->
<g id="node14" class="node">
<title>note2</title>
<polygon fill="lightyellow" stroke="black" points="639,-774 481,-774 481,-706 645,-706 645,-768 639,-774"/>
<polyline fill="none" stroke="black" points="639,-774 639,-768 "/>
<polyline fill="none" stroke="black" points="645,-768 639,-768 "/>
<text text-anchor="middle" x="563" y="-758.8" font-family="Arial" font-size="14.00">Synchronizer:</text>
<text text-anchor="middle" x="563" y="-743.8" font-family="Arial" font-size="14.00">• Gray code counters</text>
<text text-anchor="middle" x="563" y="-728.8" font-family="Arial" font-size="14.00">• Handshake FSMs</text>
<text text-anchor="middle" x="563" y="-713.8" font-family="Arial" font-size="14.00">• Metastability protection</text>
</g>
<!-- note3 -->
<g id="node15" class="node">
<title>note3</title>
<polygon fill="lightcoral" stroke="black" points="812.5,-766.5 663.5,-766.5 663.5,-713.5 818.5,-713.5 818.5,-760.5 812.5,-766.5"/>
<polyline fill="none" stroke="black" points="812.5,-766.5 812.5,-760.5 "/>
<polyline fill="none" stroke="black" points="818.5,-760.5 812.5,-760.5 "/>
<text text-anchor="middle" x="741" y="-751.3" font-family="Arial" font-size="14.00">Latency Impact:</text>
<text text-anchor="middle" x="741" y="-736.3" font-family="Arial" font-size="14.00">• No CDC: 2 cycles</text>
<text text-anchor="middle" x="741" y="-721.3" font-family="Arial" font-size="14.00">• With CDC: 4&#45;6 cycles</text>
</g>
</g>
</svg>
