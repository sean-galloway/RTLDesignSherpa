<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: periodic_timer Pages: 1 -->
<svg width="721pt" height="1033pt"
 viewBox="0.00 0.00 721.00 1033.48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1029.48)">
<title>periodic_timer</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1029.48 717,-1029.48 717,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<ellipse fill="lightgreen" stroke="black" cx="457.5" cy="-998.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="457.5" y="-1002.41" font-family="Arial" font-size="14.00">Timer Configured</text>
<text text-anchor="middle" x="457.5" y="-987.41" font-family="Arial" font-size="14.00">(Periodic Mode)</text>
</g>
<!-- timer_enabled -->
<g id="node2" class="node">
<title>timer_enabled</title>
<path fill="lightblue" stroke="black" d="M539.5,-934.74C539.5,-934.74 375.5,-934.74 375.5,-934.74 369.5,-934.74 363.5,-928.74 363.5,-922.74 363.5,-922.74 363.5,-878.74 363.5,-878.74 363.5,-872.74 369.5,-866.74 375.5,-866.74 375.5,-866.74 539.5,-866.74 539.5,-866.74 545.5,-866.74 551.5,-872.74 551.5,-878.74 551.5,-878.74 551.5,-922.74 551.5,-922.74 551.5,-928.74 545.5,-934.74 539.5,-934.74"/>
<text text-anchor="middle" x="457.5" y="-919.54" font-family="Arial" font-size="14.00">Timer Enabled</text>
<text text-anchor="middle" x="457.5" y="-904.54" font-family="Arial" font-size="14.00">TIMER_CONFIG.enable = 1</text>
<text text-anchor="middle" x="457.5" y="-889.54" font-family="Arial" font-size="14.00">TIMER_CONFIG.type = 1</text>
<text text-anchor="middle" x="457.5" y="-874.54" font-family="Arial" font-size="14.00">Period = initial comparator</text>
</g>
<!-- start&#45;&gt;timer_enabled -->
<g id="edge1" class="edge">
<title>start&#45;&gt;timer_enabled</title>
<path fill="none" stroke="black" d="M457.5,-971.67C457.5,-963.45 457.5,-954.13 457.5,-945.03"/>
<polygon fill="black" stroke="black" points="461,-944.93 457.5,-934.93 454,-944.93 461,-944.93"/>
</g>
<!-- counter_running -->
<g id="node3" class="node">
<title>counter_running</title>
<path fill="lightcyan" stroke="black" d="M533,-829.74C533,-829.74 382,-829.74 382,-829.74 376,-829.74 370,-823.74 370,-817.74 370,-817.74 370,-803.74 370,-803.74 370,-797.74 376,-791.74 382,-791.74 382,-791.74 533,-791.74 533,-791.74 539,-791.74 545,-797.74 545,-803.74 545,-803.74 545,-817.74 545,-817.74 545,-823.74 539,-829.74 533,-829.74"/>
<text text-anchor="middle" x="457.5" y="-814.54" font-family="Arial" font-size="14.00">Main Counter Running</text>
<text text-anchor="middle" x="457.5" y="-799.54" font-family="Arial" font-size="14.00">Increments every hpet_clk</text>
</g>
<!-- timer_enabled&#45;&gt;counter_running -->
<g id="edge2" class="edge">
<title>timer_enabled&#45;&gt;counter_running</title>
<path fill="none" stroke="black" d="M457.5,-866.72C457.5,-857.94 457.5,-848.54 457.5,-840.04"/>
<polygon fill="black" stroke="black" points="461,-839.87 457.5,-829.87 454,-839.87 461,-839.87"/>
</g>
<!-- compare -->
<g id="node4" class="node">
<title>compare</title>
<path fill="lightyellow" stroke="black" d="M255.82,-752C255.82,-752 117.18,-719.48 117.18,-719.48 111.34,-718.11 111.34,-715.37 117.18,-714 117.18,-714 255.82,-681.48 255.82,-681.48 261.66,-680.11 273.34,-680.11 279.18,-681.48 279.18,-681.48 417.82,-714 417.82,-714 423.66,-715.37 423.66,-718.11 417.82,-719.48 417.82,-719.48 279.18,-752 279.18,-752 273.34,-753.37 261.66,-753.37 255.82,-752"/>
<text text-anchor="middle" x="267.5" y="-720.54" font-family="Arial" font-size="14.00">Compare:</text>
<text text-anchor="middle" x="267.5" y="-705.54" font-family="Arial" font-size="14.00">counter &gt;= comparator?</text>
</g>
<!-- counter_running&#45;&gt;compare -->
<g id="edge3" class="edge">
<title>counter_running&#45;&gt;compare</title>
<path fill="none" stroke="black" d="M419.96,-791.56C393.79,-778.89 358.31,-761.71 328.16,-747.11"/>
<polygon fill="black" stroke="black" points="329.51,-743.88 318.99,-742.67 326.46,-750.18 329.51,-743.88"/>
</g>
<!-- wait_cycle -->
<g id="node5" class="node">
<title>wait_cycle</title>
<path fill="white" stroke="black" d="M450.5,-619.24C450.5,-619.24 382.5,-619.24 382.5,-619.24 376.5,-619.24 370.5,-613.24 370.5,-607.24 370.5,-607.24 370.5,-595.24 370.5,-595.24 370.5,-589.24 376.5,-583.24 382.5,-583.24 382.5,-583.24 450.5,-583.24 450.5,-583.24 456.5,-583.24 462.5,-589.24 462.5,-595.24 462.5,-595.24 462.5,-607.24 462.5,-607.24 462.5,-613.24 456.5,-619.24 450.5,-619.24"/>
<text text-anchor="middle" x="416.5" y="-597.54" font-family="Arial" font-size="14.00">Wait 1 Cycle</text>
</g>
<!-- compare&#45;&gt;wait_cycle -->
<g id="edge4" class="edge">
<title>compare&#45;&gt;wait_cycle</title>
<path fill="none" stroke="black" d="M304.71,-687.39C329.74,-668.33 362.33,-643.5 385.86,-625.58"/>
<polygon fill="black" stroke="black" points="388.25,-628.16 394.09,-619.31 384.01,-622.59 388.25,-628.16"/>
<text text-anchor="middle" x="363.5" y="-649.54" font-family="Arial" font-size="14.00">No</text>
</g>
<!-- fire_detect -->
<g id="node6" class="node">
<title>fire_detect</title>
<path fill="lightcoral" stroke="black" d="M334.5,-627.74C334.5,-627.74 200.5,-627.74 200.5,-627.74 194.5,-627.74 188.5,-621.74 188.5,-615.74 188.5,-615.74 188.5,-586.74 188.5,-586.74 188.5,-580.74 194.5,-574.74 200.5,-574.74 200.5,-574.74 334.5,-574.74 334.5,-574.74 340.5,-574.74 346.5,-580.74 346.5,-586.74 346.5,-586.74 346.5,-615.74 346.5,-615.74 346.5,-621.74 340.5,-627.74 334.5,-627.74"/>
<text text-anchor="middle" x="267.5" y="-612.54" font-family="Arial" font-size="14.00">Timer Fires!</text>
<text text-anchor="middle" x="267.5" y="-597.54" font-family="Arial" font-size="14.00">• IRQ asserts</text>
<text text-anchor="middle" x="267.5" y="-582.54" font-family="Arial" font-size="14.00">• Edge detection (0→1)</text>
</g>
<!-- compare&#45;&gt;fire_detect -->
<g id="edge5" class="edge">
<title>compare&#45;&gt;fire_detect</title>
<path fill="none" stroke="black" d="M267.5,-678.58C267.5,-665.65 267.5,-651.17 267.5,-638.33"/>
<polygon fill="black" stroke="black" points="271,-637.99 267.5,-628 264,-638 271,-637.99"/>
<text text-anchor="middle" x="279" y="-649.54" font-family="Arial" font-size="14.00">Yes</text>
</g>
<!-- wait_cycle&#45;&gt;counter_running -->
<g id="edge6" class="edge">
<title>wait_cycle&#45;&gt;counter_running</title>
<path fill="none" stroke="black" d="M422.16,-619.39C427.06,-634.78 434.05,-658.07 438.5,-678.74 446.02,-713.69 451.42,-754.54 454.5,-781.21"/>
<polygon fill="black" stroke="black" points="451.04,-781.83 455.63,-791.37 458,-781.05 451.04,-781.83"/>
</g>
<!-- auto_increment -->
<g id="node7" class="node">
<title>auto_increment</title>
<path fill="lightgreen" stroke="black" d="M349,-537.74C349,-537.74 188,-537.74 188,-537.74 182,-537.74 176,-531.74 176,-525.74 176,-525.74 176,-496.74 176,-496.74 176,-490.74 182,-484.74 188,-484.74 188,-484.74 349,-484.74 349,-484.74 355,-484.74 361,-490.74 361,-496.74 361,-496.74 361,-525.74 361,-525.74 361,-531.74 355,-537.74 349,-537.74"/>
<text text-anchor="middle" x="268.5" y="-522.54" font-family="Arial" font-size="14.00">Auto&#45;Increment Comparator</text>
<text text-anchor="middle" x="268.5" y="-507.54" font-family="Arial" font-size="14.00">comparator += period</text>
<text text-anchor="middle" x="268.5" y="-492.54" font-family="Arial" font-size="14.00">(Hardware automatic!)</text>
</g>
<!-- fire_detect&#45;&gt;auto_increment -->
<g id="edge7" class="edge">
<title>fire_detect&#45;&gt;auto_increment</title>
<path fill="none" stroke="black" d="M267.79,-574.31C267.89,-566.08 267.99,-556.82 268.09,-548.02"/>
<polygon fill="black" stroke="black" points="271.59,-548.02 268.21,-537.98 264.59,-547.94 271.59,-548.02"/>
</g>
<!-- irq_check -->
<g id="node8" class="node">
<title>irq_check</title>
<path fill="lightyellow" stroke="black" d="M261.89,-442.14C261.89,-442.14 211.11,-415.34 211.11,-415.34 205.81,-412.54 205.81,-406.94 211.11,-404.14 211.11,-404.14 261.89,-377.34 261.89,-377.34 267.19,-374.54 277.81,-374.54 283.11,-377.34 283.11,-377.34 333.89,-404.14 333.89,-404.14 339.19,-406.94 339.19,-412.54 333.89,-415.34 333.89,-415.34 283.11,-442.14 283.11,-442.14 277.81,-444.94 267.19,-444.94 261.89,-442.14"/>
<text text-anchor="middle" x="272.5" y="-413.54" font-family="Arial" font-size="14.00">Interrupt</text>
<text text-anchor="middle" x="272.5" y="-398.54" font-family="Arial" font-size="14.00">enabled?</text>
</g>
<!-- auto_increment&#45;&gt;irq_check -->
<g id="edge8" class="edge">
<title>auto_increment&#45;&gt;irq_check</title>
<path fill="none" stroke="black" d="M269.53,-484.62C269.87,-476.24 270.25,-466.67 270.63,-457.25"/>
<polygon fill="black" stroke="black" points="274.13,-457.29 271.04,-447.15 267.14,-457 274.13,-457.29"/>
</g>
<!-- irq_assert -->
<g id="node9" class="node">
<title>irq_assert</title>
<path fill="red" stroke="black" d="M333.5,-320.74C333.5,-320.74 211.5,-320.74 211.5,-320.74 205.5,-320.74 199.5,-314.74 199.5,-308.74 199.5,-308.74 199.5,-279.74 199.5,-279.74 199.5,-273.74 205.5,-267.74 211.5,-267.74 211.5,-267.74 333.5,-267.74 333.5,-267.74 339.5,-267.74 345.5,-273.74 345.5,-279.74 345.5,-279.74 345.5,-308.74 345.5,-308.74 345.5,-314.74 339.5,-320.74 333.5,-320.74"/>
<text text-anchor="middle" x="272.5" y="-305.54" font-family="Arial" font-size="14.00" fill="white">Interrupt Asserted</text>
<text text-anchor="middle" x="272.5" y="-290.54" font-family="Arial" font-size="14.00" fill="white">timer_irq[i] = 1</text>
<text text-anchor="middle" x="272.5" y="-275.54" font-family="Arial" font-size="14.00" fill="white">HPET_STATUS[i] = 1</text>
</g>
<!-- irq_check&#45;&gt;irq_assert -->
<g id="edge9" class="edge">
<title>irq_check&#45;&gt;irq_assert</title>
<path fill="none" stroke="black" d="M272.5,-371.58C272.5,-358.65 272.5,-344.17 272.5,-331.33"/>
<polygon fill="black" stroke="black" points="276,-330.99 272.5,-321 269,-331 276,-330.99"/>
<text text-anchor="middle" x="284" y="-342.54" font-family="Arial" font-size="14.00">Yes</text>
</g>
<!-- continue_running -->
<g id="node10" class="node">
<title>continue_running</title>
<path fill="lightcyan" stroke="black" d="M519,-53.37C519,-53.37 380,-53.37 380,-53.37 374,-53.37 368,-47.37 368,-41.37 368,-41.37 368,-12.37 368,-12.37 368,-6.37 374,-0.37 380,-0.37 380,-0.37 519,-0.37 519,-0.37 525,-0.37 531,-6.37 531,-12.37 531,-12.37 531,-41.37 531,-41.37 531,-47.37 525,-53.37 519,-53.37"/>
<text text-anchor="middle" x="449.5" y="-38.17" font-family="Arial" font-size="14.00">Timer Continues</text>
<text text-anchor="middle" x="449.5" y="-23.17" font-family="Arial" font-size="14.00">Waiting for next fire</text>
<text text-anchor="middle" x="449.5" y="-8.17" font-family="Arial" font-size="14.00">at (comparator + period)</text>
</g>
<!-- irq_check&#45;&gt;continue_running -->
<g id="edge10" class="edge">
<title>irq_check&#45;&gt;continue_running</title>
<path fill="none" stroke="black" d="M323.7,-398.74C375.97,-385.21 449.5,-355.47 449.5,-295.24 449.5,-295.24 449.5,-295.24 449.5,-116.24 449.5,-98.87 449.5,-79.58 449.5,-63.47"/>
<polygon fill="black" stroke="black" points="453,-63.39 449.5,-53.39 446,-63.39 453,-63.39"/>
<text text-anchor="middle" x="458.5" y="-209.04" font-family="Arial" font-size="14.00">No</text>
</g>
<!-- sw_action -->
<g id="node11" class="node">
<title>sw_action</title>
<path fill="lightyellow" stroke="black" d="M260.6,-229.21C260.6,-229.21 144.48,-214.27 144.48,-214.27 138.53,-213.51 138.53,-211.97 144.48,-211.21 144.48,-211.21 260.6,-196.27 260.6,-196.27 266.55,-195.51 278.45,-195.51 284.4,-196.27 284.4,-196.27 400.52,-211.21 400.52,-211.21 406.47,-211.97 406.47,-213.51 400.52,-214.27 400.52,-214.27 284.4,-229.21 284.4,-229.21 278.45,-229.97 266.55,-229.97 260.6,-229.21"/>
<text text-anchor="middle" x="272.5" y="-209.04" font-family="Arial" font-size="14.00">Software Handles IRQ</text>
</g>
<!-- irq_assert&#45;&gt;sw_action -->
<g id="edge11" class="edge">
<title>irq_assert&#45;&gt;sw_action</title>
<path fill="none" stroke="black" d="M272.5,-267.65C272.5,-259.22 272.5,-249.82 272.5,-241.26"/>
<polygon fill="black" stroke="black" points="276,-241 272.5,-231 269,-241 276,-241"/>
</g>
<!-- continue_running&#45;&gt;counter_running -->
<g id="edge16" class="edge">
<title>continue_running&#45;&gt;counter_running</title>
<path fill="none" stroke="black" d="M471.15,-53.54C483.08,-70.28 495.5,-93.24 495.5,-116.24 495.5,-717.74 495.5,-717.74 495.5,-717.74 495.5,-740.99 485,-765.21 475.04,-782.97"/>
<polygon fill="black" stroke="black" points="472.01,-781.23 469.94,-791.62 478.04,-784.78 472.01,-781.23"/>
</g>
<!-- sw_clear -->
<g id="node12" class="node">
<title>sw_clear</title>
<path fill="lightgreen" stroke="black" d="M409.5,-143.74C409.5,-143.74 233.5,-143.74 233.5,-143.74 227.5,-143.74 221.5,-137.74 221.5,-131.74 221.5,-131.74 221.5,-102.74 221.5,-102.74 221.5,-96.74 227.5,-90.74 233.5,-90.74 233.5,-90.74 409.5,-90.74 409.5,-90.74 415.5,-90.74 421.5,-96.74 421.5,-102.74 421.5,-102.74 421.5,-131.74 421.5,-131.74 421.5,-137.74 415.5,-143.74 409.5,-143.74"/>
<text text-anchor="middle" x="321.5" y="-128.54" font-family="Arial" font-size="14.00">Clear Interrupt</text>
<text text-anchor="middle" x="321.5" y="-113.54" font-family="Arial" font-size="14.00">WRITE(HPET_STATUS, 1&lt;&lt;i)</text>
<text text-anchor="middle" x="321.5" y="-98.54" font-family="Arial" font-size="14.00">(W1C)</text>
</g>
<!-- sw_action&#45;&gt;sw_clear -->
<g id="edge12" class="edge">
<title>sw_action&#45;&gt;sw_clear</title>
<path fill="none" stroke="black" d="M281.04,-195.45C287.15,-183.78 295.62,-167.62 303.23,-153.09"/>
<polygon fill="black" stroke="black" points="306.54,-154.33 308.08,-143.85 300.34,-151.08 306.54,-154.33"/>
<text text-anchor="middle" x="328" y="-165.54" font-family="Arial" font-size="14.00">Clear IRQ</text>
</g>
<!-- sw_disable -->
<g id="node13" class="node">
<title>sw_disable</title>
<path fill="orange" stroke="black" d="M191,-136.24C191,-136.24 12,-136.24 12,-136.24 6,-136.24 0,-130.24 0,-124.24 0,-124.24 0,-110.24 0,-110.24 0,-104.24 6,-98.24 12,-98.24 12,-98.24 191,-98.24 191,-98.24 197,-98.24 203,-104.24 203,-110.24 203,-110.24 203,-124.24 203,-124.24 203,-130.24 197,-136.24 191,-136.24"/>
<text text-anchor="middle" x="101.5" y="-121.04" font-family="Arial" font-size="14.00">Disable Timer</text>
<text text-anchor="middle" x="101.5" y="-106.04" font-family="Arial" font-size="14.00">WRITE(TIMER_CONFIG, 0x0)</text>
</g>
<!-- sw_action&#45;&gt;sw_disable -->
<g id="edge13" class="edge">
<title>sw_action&#45;&gt;sw_disable</title>
<path fill="none" stroke="black" d="M243.93,-198.23C230.88,-191.92 215.3,-184.16 201.5,-176.74 180.95,-165.68 158.49,-152.63 140.07,-141.67"/>
<polygon fill="black" stroke="black" points="141.76,-138.6 131.38,-136.47 138.16,-144.61 141.76,-138.6"/>
<text text-anchor="middle" x="244" y="-165.54" font-family="Arial" font-size="14.00">Disable Timer</text>
</g>
<!-- sw_clear&#45;&gt;continue_running -->
<g id="edge14" class="edge">
<title>sw_clear&#45;&gt;continue_running</title>
<path fill="none" stroke="black" d="M358.52,-90.68C372.72,-80.88 389.08,-69.58 403.98,-59.29"/>
<polygon fill="black" stroke="black" points="406.32,-61.93 412.56,-53.37 402.34,-56.17 406.32,-61.93"/>
</g>
<!-- end -->
<g id="node14" class="node">
<title>end</title>
<ellipse fill="orange" stroke="black" cx="101.5" cy="-26.87" rx="94.09" ry="26.74"/>
<text text-anchor="middle" x="101.5" y="-30.67" font-family="Arial" font-size="14.00">Timer Stopped</text>
<text text-anchor="middle" x="101.5" y="-15.67" font-family="Arial" font-size="14.00">(Software disabled)</text>
</g>
<!-- sw_disable&#45;&gt;end -->
<g id="edge15" class="edge">
<title>sw_disable&#45;&gt;end</title>
<path fill="none" stroke="black" d="M101.5,-97.93C101.5,-88.18 101.5,-75.82 101.5,-64.22"/>
<polygon fill="black" stroke="black" points="105,-63.87 101.5,-53.87 98,-63.87 105,-63.87"/>
</g>
<!-- loop -->
<g id="node15" class="node">
<title>loop</title>
<polygon fill="yellow" stroke="black" points="677.5,-45.87 549.5,-45.87 549.5,-7.87 683.5,-7.87 683.5,-39.87 677.5,-45.87"/>
<polyline fill="none" stroke="black" points="677.5,-45.87 677.5,-39.87 "/>
<polyline fill="none" stroke="black" points="683.5,-39.87 677.5,-39.87 "/>
<text text-anchor="middle" x="616.5" y="-30.67" font-family="Arial" font-size="14.00">Repeats indefinitely</text>
<text text-anchor="middle" x="616.5" y="-15.67" font-family="Arial" font-size="14.00">until disabled</text>
</g>
<!-- note1 -->
<g id="node16" class="node">
<title>note1</title>
<polygon fill="lightyellow" stroke="black" points="707,-919.74 570,-919.74 570,-881.74 713,-881.74 713,-913.74 707,-919.74"/>
<polyline fill="none" stroke="black" points="707,-919.74 707,-913.74 "/>
<polyline fill="none" stroke="black" points="713,-913.74 707,-913.74 "/>
<text text-anchor="middle" x="641.5" y="-904.54" font-family="Arial" font-size="14.00">Note: Periodic timers</text>
<text text-anchor="middle" x="641.5" y="-889.54" font-family="Arial" font-size="14.00">fire REPEATEDLY</text>
</g>
<!-- note2 -->
<g id="node17" class="node">
<title>note2</title>
<polygon fill="lightyellow" stroke="black" points="691,-530.24 524,-530.24 524,-492.24 697,-492.24 697,-524.24 691,-530.24"/>
<polyline fill="none" stroke="black" points="691,-530.24 691,-524.24 "/>
<polyline fill="none" stroke="black" points="697,-524.24 691,-524.24 "/>
<text text-anchor="middle" x="610.5" y="-515.04" font-family="Arial" font-size="14.00">Note: Comparator</text>
<text text-anchor="middle" x="610.5" y="-500.04" font-family="Arial" font-size="14.00">auto&#45;increments by period</text>
</g>
</g>
</svg>
