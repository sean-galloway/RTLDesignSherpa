<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: ioapic_delivery_fsm Pages: 1 -->
<svg width="342pt" height="480pt"
 viewBox="0.00 0.00 341.50 480.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 476)">
<title>ioapic_delivery_fsm</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-476 337.5,-476 337.5,4 -4,4"/>
<text text-anchor="middle" x="166.75" y="-458.4" font-family="Arial" font-size="12.00">IOAPIC Interrupt Delivery State Machine</text>
<!-- IDLE -->
<g id="node1" class="node">
<title>IDLE</title>
<path fill="lightgreen" stroke="black" d="M211,-451C211,-451 102,-451 102,-451 96,-451 90,-445 90,-439 90,-439 90,-394 90,-394 90,-388 96,-382 102,-382 102,-382 211,-382 211,-382 217,-382 223,-388 223,-394 223,-394 223,-439 223,-439 223,-445 217,-451 211,-451"/>
<text text-anchor="middle" x="156.5" y="-438.2" font-family="Arial" font-size="11.00">IDLE</text>
<text text-anchor="middle" x="156.5" y="-413.2" font-family="Arial" font-size="11.00">• Arbitrate pending IRQs</text>
<text text-anchor="middle" x="156.5" y="-401.2" font-family="Arial" font-size="11.00">• Select highest priority</text>
<text text-anchor="middle" x="156.5" y="-389.2" font-family="Arial" font-size="11.00">• irq_out_valid = 0</text>
</g>
<!-- IDLE&#45;&gt;IDLE -->
<g id="edge1" class="edge">
<title>IDLE&#45;&gt;IDLE</title>
<path fill="none" stroke="blue" d="M223.1,-428.24C233.72,-426.52 241,-422.61 241,-416.5 241,-412.59 238.01,-409.57 233.07,-407.46"/>
<polygon fill="blue" stroke="blue" points="233.66,-404 223.1,-404.76 231.83,-410.75 233.66,-404"/>
<text text-anchor="middle" x="285.5" y="-419.5" font-family="Arial" font-size="10.00">No pending IRQs</text>
<text text-anchor="middle" x="285.5" y="-408.5" font-family="Arial" font-size="10.00">(continue arbitration)</text>
</g>
<!-- DELIVER -->
<g id="node2" class="node">
<title>DELIVER</title>
<path fill="lightyellow" stroke="black" d="M117,-313C117,-313 12,-313 12,-313 6,-313 0,-307 0,-301 0,-301 0,-256 0,-256 0,-250 6,-244 12,-244 12,-244 117,-244 117,-244 123,-244 129,-250 129,-256 129,-256 129,-301 129,-301 129,-307 123,-313 117,-313"/>
<text text-anchor="middle" x="64.5" y="-300.2" font-family="Arial" font-size="11.00">DELIVER</text>
<text text-anchor="middle" x="64.5" y="-275.2" font-family="Arial" font-size="11.00">• Assert irq_out_valid</text>
<text text-anchor="middle" x="64.5" y="-263.2" font-family="Arial" font-size="11.00">• Present vector, dest</text>
<text text-anchor="middle" x="64.5" y="-251.2" font-family="Arial" font-size="11.00">• Wait for irq_out_ready</text>
</g>
<!-- IDLE&#45;&gt;DELIVER -->
<g id="edge2" class="edge">
<title>IDLE&#45;&gt;DELIVER</title>
<path fill="none" stroke="darkgreen" stroke-width="2" d="M89.87,-396.86C74.34,-389.25 59.67,-378.65 50.5,-364 42.95,-351.93 43,-337.07 46.03,-323.19"/>
<polygon fill="darkgreen" stroke="darkgreen" stroke-width="2" points="49.47,-323.88 48.7,-313.31 42.71,-322.05 49.47,-323.88"/>
<text text-anchor="middle" x="92.5" y="-350.5" font-family="Arial" font-size="10.00">Pending IRQ found</text>
<text text-anchor="middle" x="92.5" y="-339.5" font-family="Arial" font-size="10.00">(latch IRQ info)</text>
</g>
<!-- DELIVER&#45;&gt;IDLE -->
<g id="edge4" class="edge">
<title>DELIVER&#45;&gt;IDLE</title>
<path fill="none" stroke="darkgreen" stroke-width="2" d="M118.62,-313.12C124.6,-318.52 130.1,-324.51 134.5,-331 142.64,-343.02 147.77,-357.87 151,-371.75"/>
<polygon fill="darkgreen" stroke="darkgreen" stroke-width="2" points="147.59,-372.54 153.04,-381.63 154.45,-371.13 147.59,-372.54"/>
<text text-anchor="middle" x="187.5" y="-356" font-family="Arial" font-size="10.00">irq_out_ready &amp;&amp;</text>
<text text-anchor="middle" x="187.5" y="-345" font-family="Arial" font-size="10.00">EDGE mode</text>
<text text-anchor="middle" x="187.5" y="-334" font-family="Arial" font-size="10.00">(complete)</text>
</g>
<!-- DELIVER&#45;&gt;DELIVER -->
<g id="edge3" class="edge">
<title>DELIVER&#45;&gt;DELIVER</title>
<path fill="none" stroke="blue" d="M129.18,-290.3C139.74,-288.61 147,-284.68 147,-278.5 147,-274.54 144.02,-271.51 139.1,-269.39"/>
<polygon fill="blue" stroke="blue" points="139.75,-265.94 129.18,-266.7 137.92,-272.7 139.75,-265.94"/>
<text text-anchor="middle" x="179" y="-281.5" font-family="Arial" font-size="10.00">!irq_out_ready</text>
<text text-anchor="middle" x="179" y="-270.5" font-family="Arial" font-size="10.00">(wait for CPU)</text>
</g>
<!-- WAIT_EOI -->
<g id="node3" class="node">
<title>WAIT_EOI</title>
<path fill="lightcoral" stroke="black" d="M196,-175C196,-175 117,-175 117,-175 111,-175 105,-169 105,-163 105,-163 105,-118 105,-118 105,-112 111,-106 117,-106 117,-106 196,-106 196,-106 202,-106 208,-112 208,-118 208,-118 208,-163 208,-163 208,-169 202,-175 196,-175"/>
<text text-anchor="middle" x="156.5" y="-162.2" font-family="Arial" font-size="11.00">WAIT_EOI</text>
<text text-anchor="middle" x="156.5" y="-137.2" font-family="Arial" font-size="11.00">• Remote IRR set</text>
<text text-anchor="middle" x="156.5" y="-125.2" font-family="Arial" font-size="11.00">• Wait for EOI</text>
<text text-anchor="middle" x="156.5" y="-113.2" font-family="Arial" font-size="11.00">• irq_out_valid = 0</text>
</g>
<!-- DELIVER&#45;&gt;WAIT_EOI -->
<g id="edge5" class="edge">
<title>DELIVER&#45;&gt;WAIT_EOI</title>
<path fill="none" stroke="darkorange" stroke-width="2" d="M87.24,-243.88C99.57,-225.66 114.93,-202.96 128.04,-183.57"/>
<polygon fill="darkorange" stroke="darkorange" stroke-width="2" points="131,-185.45 133.7,-175.2 125.2,-181.52 131,-185.45"/>
<text text-anchor="middle" x="161" y="-218" font-family="Arial" font-size="10.00">irq_out_ready &amp;&amp;</text>
<text text-anchor="middle" x="161" y="-207" font-family="Arial" font-size="10.00">LEVEL mode</text>
<text text-anchor="middle" x="161" y="-196" font-family="Arial" font-size="10.00">(set Remote IRR)</text>
</g>
<!-- WAIT_EOI&#45;&gt;IDLE -->
<g id="edge7" class="edge">
<title>WAIT_EOI&#45;&gt;IDLE</title>
<path fill="none" stroke="darkgreen" stroke-width="2" d="M191.92,-175.22C196.61,-180.83 200.99,-186.84 204.5,-193 242.54,-259.73 264.85,-295.81 229.5,-364 227.63,-367.61 225.37,-371.03 222.83,-374.25"/>
<polygon fill="darkgreen" stroke="darkgreen" stroke-width="2" points="220.08,-372.07 215.98,-381.84 225.27,-376.76 220.08,-372.07"/>
<text text-anchor="middle" x="290.5" y="-287" font-family="Arial" font-size="10.00">eoi_in &amp;&amp;</text>
<text text-anchor="middle" x="290.5" y="-276" font-family="Arial" font-size="10.00">vector match</text>
<text text-anchor="middle" x="290.5" y="-265" font-family="Arial" font-size="10.00">(clear Remote IRR)</text>
</g>
<!-- WAIT_EOI&#45;&gt;WAIT_EOI -->
<g id="edge6" class="edge">
<title>WAIT_EOI&#45;&gt;WAIT_EOI</title>
<path fill="none" stroke="blue" d="M208.03,-152.76C218.5,-151.43 226,-147.34 226,-140.5 226,-136.12 222.92,-132.87 217.96,-130.74"/>
<polygon fill="blue" stroke="blue" points="218.58,-127.29 208.03,-128.24 216.86,-134.08 218.58,-127.29"/>
<text text-anchor="middle" x="271.5" y="-143.5" font-family="Arial" font-size="10.00">Waiting for EOI</text>
<text text-anchor="middle" x="271.5" y="-132.5" font-family="Arial" font-size="10.00">(or vector mismatch)</text>
</g>
<!-- legend -->
<g id="node4" class="node">
<title>legend</title>
<path fill="lightblue" stroke="transparent" d="M203,-88C203,-88 110,-88 110,-88 104,-88 98,-82 98,-76 98,-76 98,-12 98,-12 98,-6 104,0 110,0 110,0 203,0 203,0 209,0 215,-6 215,-12 215,-12 215,-76 215,-76 215,-82 209,-88 203,-88"/>
<polygon fill="lightblue" stroke="transparent" points="98.5,-66 98.5,-88 215.5,-88 215.5,-66 98.5,-66"/>
<polygon fill="none" stroke="black" points="98.5,-66 98.5,-88 215.5,-88 215.5,-66 98.5,-66"/>
<text text-anchor="start" x="137" y="-75.2" font-family="Arial" font-weight="bold" font-size="11.00">Legend</text>
<polygon fill="none" stroke="black" points="98.5,-44 98.5,-66 215.5,-66 215.5,-44 98.5,-44"/>
<text text-anchor="start" x="103.5" y="-53.2" font-family="Arial" font-size="11.00" fill="blue">■</text>
<text text-anchor="start" x="110.5" y="-53.2" font-family="Arial" font-size="11.00"> Stay in state</text>
<polygon fill="none" stroke="black" points="98.5,-22 98.5,-44 215.5,-44 215.5,-22 98.5,-22"/>
<text text-anchor="start" x="103.5" y="-31.2" font-family="Arial" font-size="11.00" fill="darkgreen">■</text>
<text text-anchor="start" x="110.5" y="-31.2" font-family="Arial" font-size="11.00"> State transition</text>
<polygon fill="none" stroke="black" points="98.5,0 98.5,-22 215.5,-22 215.5,0 98.5,0"/>
<text text-anchor="start" x="103.5" y="-9.2" font-family="Arial" font-size="11.00" fill="darkorange">■</text>
<text text-anchor="start" x="110.5" y="-9.2" font-family="Arial" font-size="11.00"> Level&#45;triggered path</text>
</g>
</g>
</svg>
