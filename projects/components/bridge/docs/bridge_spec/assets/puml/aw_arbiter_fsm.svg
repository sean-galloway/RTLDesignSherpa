<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="650px" preserveAspectRatio="none" style="width:898px;height:650px;" version="1.1" viewBox="0 0 898 650" width="898px" zoomAndPan="magnify"><defs><filter height="300%" id="fxcirustew9a4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="378" x="263" y="19.2419">AW Channel Arbiter FSM (Per-Slave Instance)</text><ellipse cx="401" cy="42.5158" fill="#000000" filter="url(#fxcirustew9a4)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><path d="M573.5,131.5158 L573.5,221.0158 L538.72,225.0158 L573.5,229.0158 L573.5,318.576 A0,0 0 0 0 573.5,318.576 L852.5,318.576 A0,0 0 0 0 852.5,318.576 L852.5,141.5158 L842.5,131.5158 L573.5,131.5158 A0,0 0 0 0 573.5,131.5158 " fill="#FBFB77" filter="url(#fxcirustew9a4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M842.5,131.5158 L842.5,141.5158 L852.5,141.5158 L842.5,131.5158 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="166" x="579.5" y="150.4129">Round-Robin Arbitration:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="579.5" y="168.1189">Priority rotates after each grant:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="579.5" y="185.8249">- Start search from (aw_last_grant[s] + 1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="579.5" y="203.5309">- Find first requesting master</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="579.5" y="221.2369">- Update aw_last_grant[s] = winning master</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="582.5" y="238.9429"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="132" x="579.5" y="256.649">Fairness Guarantee:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="579.5" y="274.355">- No master starvation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="579.5" y="292.061">- All masters get equal opportunity</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="257" x="579.5" y="309.767">- Priority rotation prevents monopolization</text><path d="M580,451.5158 L580,532.0158 L545.28,536.0158 L580,540.0158 L580,620.87 A0,0 0 0 0 580,620.87 L886,620.87 A0,0 0 0 0 886,620.87 L886,461.5158 L876,451.5158 L580,451.5158 A0,0 0 0 0 580,451.5158 " fill="#FBFB77" filter="url(#fxcirustew9a4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M876,451.5158 L876,461.5158 L886,461.5158 L876,451.5158 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="586" y="470.4129">Grant Locking:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="257" x="586" y="488.1189">- Grant held until AW handshake completes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="284" x="586" y="505.8249">- W channel follows AW grant (data path locked)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="252" x="586" y="523.5309">- B channel uses ID table (not grant-based)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="589" y="541.2369"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="223" x="586" y="558.9429">Independent from AR Arbitration:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="273" x="586" y="576.649">- Read and write paths operate independently</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="285" x="586" y="594.355">- No head-of-line blocking between reads/writes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="222" x="586" y="612.061">- Each slave has 2 arbiters: AW and AR</text><path d="M6,433.5158 L6,638.282 A0,0 0 0 0 6,638.282 L222,638.282 A0,0 0 0 0 222,638.282 L222,540.0158 L256.76,536.0158 L222,532.0158 L222,443.5158 L212,433.5158 L6,433.5158 A0,0 0 0 0 6,433.5158 " fill="#FBFB77" filter="url(#fxcirustew9a4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M212,433.5158 L212,443.5158 L222,443.5158 L212,433.5158 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="174" x="12" y="452.4129">Address Phase Handshake:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="15" y="470.1189"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="12" y="487.8249">AW transaction completes when:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="18" y="505.5309">AWVALID = 1 (from master)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="18" y="523.2369">AWREADY = 1 (from slave)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="18" y="540.9429">Rising edge of clock</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="15" y="558.649"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="12" y="576.355">After handshake:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="12" y="594.061">- Grant released</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="12" y="611.767">- Arbiter returns to IDLE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="12" y="629.473">- Ready for next arbitration</text><rect fill="#FEFECE" filter="url(#fxcirustew9a4)" height="104.4444" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="275" x="263.5" y="173.0158"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="263.5" x2="538.5" y1="202.0838" y2="202.0838"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="386" y="192.9818">IDLE</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="161" x="268.5" y="219.9119">Entry: aw_grant_matrix[s] = 0</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="158" x="268.5" y="236.256">Entry: aw_grant_active[s] = 0</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="161" x="268.5" y="252.6001">Wait for master AW requests</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="255" x="268.5" y="268.9442">Round-robin priority tracking: aw_last_grant[s]</text><rect fill="#FEFECE" filter="url(#fxcirustew9a4)" height="120.7885" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="288" x="257" y="475.5158"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="257" x2="545" y1="504.5838" y2="504.5838"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="351" y="495.4818">GRANT_ACTIVE</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="209" x="262" y="522.4119">Entry: Grant issued to winning master</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="180" x="262" y="538.756">Entry: aw_grant_matrix[s][m] = 1</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="158" x="262" y="555.1001">Entry: aw_grant_active[s] = 1</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="223" x="262" y="571.4442">Grant locked until handshake completes</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="268" x="262" y="587.7883">AWVALID &amp;&amp; AWREADY → transaction complete</text><!--MD5=[9c5673dd9f569fe24504060ab78be963]
link *start to IDLE--><path d="M401,52.7158 C401,73.6558 401,126.2858 401,167.7358 " fill="none" id="*start-&gt;IDLE" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="401,172.9858,405,163.9858,401,167.9858,397,163.9858,401,172.9858" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="402" y="97.4129">Reset / Power-On</text><!--MD5=[75264694667a78871ed7a8d5a2e66d87]
link IDLE to GRANT_ACTIVE--><path d="M342.93,277.1758 C324.23,297.3158 305.82,321.9858 296,348.5158 C287.52,371.4458 287.92,380.4458 296,403.5158 C304.6,428.0758 319.93,451.4558 336.26,471.5158 " fill="none" id="IDLE-&gt;GRANT_ACTIVE" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="339.53,475.4858,336.8828,465.9994,336.346,471.6307,330.7146,471.0939,339.53,475.4858" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="297" y="363.4129">|aw_request_matrix[s]| &gt; 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="306.5" y="381.1189">Round-robin arbitration</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="320" y="398.8249">Selects next master</text><!--MD5=[2707df2912cc3de3b510316c3458e837]
link GRANT_ACTIVE to IDLE--><path d="M439.36,475.3358 C458.04,439.1158 474.45,391.6958 464,348.5158 C458.43,325.5058 447.74,301.9658 436.73,281.7558 " fill="none" id="GRANT_ACTIVE-&gt;IDLE" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="434.23,277.2258,435.0796,287.038,436.6473,281.6027,442.0826,283.1703,434.23,277.2258" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="484.5" y="363.4129">m_axi_awvalid[s] &amp;&amp;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="493" y="381.1189">m_axi_awready[s]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="468" y="398.8249">(AW handshake complete)</text><!--MD5=[095c7d0da0e68e6d68a6f03516748f45]
@startuml aw_arbiter_fsm

title AW Channel Arbiter FSM (Per-Slave Instance)

[*] - -> IDLE : Reset / Power-On

state IDLE {
  IDLE : Entry: aw_grant_matrix[s] = 0
  IDLE : Entry: aw_grant_active[s] = 0
  IDLE : Wait for master AW requests
  IDLE : Round-robin priority tracking: aw_last_grant[s]
}

state GRANT_ACTIVE {
  GRANT_ACTIVE : Entry: Grant issued to winning master
  GRANT_ACTIVE : Entry: aw_grant_matrix[s][m] = 1
  GRANT_ACTIVE : Entry: aw_grant_active[s] = 1
  GRANT_ACTIVE : Grant locked until handshake completes
  GRANT_ACTIVE : AWVALID && AWREADY → transaction complete
}

IDLE - -> GRANT_ACTIVE : |aw_request_matrix[s]| > 0\nRound-robin arbitration\nSelects next master
GRANT_ACTIVE - -> IDLE : m_axi_awvalid[s] &&\nm_axi_awready[s]\n(AW handshake complete)

note right of IDLE
  **Round-Robin Arbitration:**
  Priority rotates after each grant:
  - Start search from (aw_last_grant[s] + 1)
  - Find first requesting master
  - Update aw_last_grant[s] = winning master

  **Fairness Guarantee:**
  - No master starvation
  - All masters get equal opportunity
  - Priority rotation prevents monopolization
end note

note right of GRANT_ACTIVE
  **Grant Locking:**
  - Grant held until AW handshake completes
  - W channel follows AW grant (data path locked)
  - B channel uses ID table (not grant-based)

  **Independent from AR Arbitration:**
  - Read and write paths operate independently
  - No head-of-line blocking between reads/writes
  - Each slave has 2 arbiters: AW and AR
end note

note left of GRANT_ACTIVE
  **Address Phase Handshake:**

  AW transaction completes when:
    AWVALID = 1 (from master)
    AWREADY = 1 (from slave)
    Rising edge of clock

  After handshake:
  - Grant released
  - Arbiter returns to IDLE
  - Ready for next arbitration
end note

@enduml

PlantUML version 1.2020.02(Sun Mar 01 02:22:07 PST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.8+9-Ubuntu-0ubuntu124.04.1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>