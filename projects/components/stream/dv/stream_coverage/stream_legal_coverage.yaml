# STREAM Component - Legal Coverage Variations
#
# This file defines the LEGAL variations that the STREAM component
# actually supports, rather than the full AXI4 protocol space.
#
# Coverage is calculated against these legal variations only.
# This gives realistic coverage numbers instead of measuring against
# the entire AXI4 protocol which STREAM doesn't fully implement.
#
# Usage:
#   coverage_helper = CoverageHelper(test_name, legal_config='stream')
#   # Coverage will now be measured against these legal points only

# ===========================================================================
# STREAM Component Configuration
# ===========================================================================

name: stream
description: STREAM DMA engine legal coverage points
version: "1.0"

# ===========================================================================
# AXI Burst Type Coverage
# ===========================================================================
# STREAM only uses INCR bursts for memory access
# FIXED/WRAP are not used in the current design

axi_burst_types:
  legal:
    - INCR         # Incrementing burst - used for all memory transfers
  # Not supported in current STREAM design:
  illegal:
    - FIXED        # Not used - would require special handling
    - WRAP         # Not used - adds complexity for DMA operations

# ===========================================================================
# AXI Burst Size Coverage
# ===========================================================================
# STREAM is configured with DATA_WIDTH=512 bits = 64 bytes
# It uses full-width transfers only (size=6 means 64 bytes)

axi_burst_sizes:
  legal:
    - size_64      # 64-byte transfers (DATA_WIDTH=512)
  # Narrow transfers are not used:
  illegal:
    - size_1
    - size_2
    - size_4
    - size_8
    - size_16
    - size_32
    - size_128     # Larger than datapath

# ===========================================================================
# AXI Burst Length Coverage
# ===========================================================================
# STREAM generates bursts based on descriptor size
# Common patterns: single beat, short/medium bursts

axi_burst_lengths:
  legal:
    - len_1        # Single beat (len=0) - small transfers
    - len_5_8      # Medium burst (len=4-7) - typical DMA
  # Less common but should be tested:
  optional:
    - len_2_4      # Short burst (len=1-3)
    - len_9_16     # Long burst (len=8-15)
  # Very long bursts may be generated for large transfers:
  extended:
    - len_17_256   # Very long burst (len=16-255)

# ===========================================================================
# AXI Response Coverage
# ===========================================================================
# STREAM should handle OKAY and error responses

axi_responses:
  legal:
    - OKAY         # Normal completion
    - SLVERR       # Slave error (should be handled gracefully)
  # Exclusive access not used by STREAM:
  illegal:
    - EXOKAY       # Exclusive okay - not applicable
  # Decode error depends on system:
  optional:
    - DECERR       # Decode error (address unmapped)

# ===========================================================================
# APB Transaction Coverage
# ===========================================================================
# STREAM uses APB for control register access

apb_transactions:
  legal:
    - write_okay   # Register writes
    - read_okay    # Register reads (status, configuration)
  # Error responses may occur for invalid addresses:
  optional:
    - write_error
    - read_error

# ===========================================================================
# Address Alignment Coverage
# ===========================================================================
# STREAM requires aligned addresses for optimal performance

address_alignment:
  legal:
    - cache_line   # 64-byte aligned (optimal for memory)
    - dword        # 8-byte aligned
  # Supported but less common:
  optional:
    - qword        # 16-byte aligned
    - word         # 4-byte aligned
  # Not typically generated by STREAM:
  illegal:
    - halfword     # 2-byte aligned
    - unaligned    # Unaligned access

# ===========================================================================
# Handshake Coverage
# ===========================================================================
# Key valid/ready interfaces in STREAM

handshakes:
  legal:
    - desc_valid_ready      # Descriptor interface
    - desc_done             # Descriptor completion
    - mem_cmd_valid_ready   # Memory command interface
    - mem_data_valid_ready  # Memory data interface
    - backpressure_stall    # Backpressure handling
  # Optional interfaces depending on configuration:
  optional:
    - network_tx_valid_ready
    - network_rx_valid_ready
    - scheduler_to_read_engine
    - scheduler_to_write_engine
    - read_engine_complete
    - write_engine_complete
    - pipeline_bubble

# ===========================================================================
# Scenario Coverage
# ===========================================================================
# Functional scenarios that should be tested

scenarios:
  critical:
    - single_desc          # Basic single descriptor
    - chained_desc         # Descriptor chaining
    - error_handling       # Error injection/recovery
    - timeout_recovery     # Timeout detection
  important:
    - concurrent_rw        # Concurrent read/write
    - back_to_back         # Back-to-back transactions
    - backpressure         # Flow control
  optional:
    - full_pipeline        # Pipeline stress
    - max_outstanding      # Maximum transactions
    - empty_desc           # Edge case: empty descriptor
    - wrap_burst           # Not used but could test
    - narrow_transfer      # Not used but could test

# ===========================================================================
# Cross Coverage
# ===========================================================================
# STREAM only uses specific combinations

burst_type_x_size:
  legal:
    - INCR_size64          # Only legal combination for STREAM
  illegal:
    - FIXED_size1
    - FIXED_size2
    - FIXED_size4
    - FIXED_size8
    - INCR_size1
    - INCR_size2
    - INCR_size4
    - INCR_size8
    - WRAP_size1
    - WRAP_size2
    - WRAP_size4
    - WRAP_size8
