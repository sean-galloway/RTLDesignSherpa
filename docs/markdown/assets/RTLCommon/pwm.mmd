%%{init: {'theme': 'neutral', 'themeVariables': { 'fontSize': '14px'}}}%%
flowchart TB
    subgraph Inputs
        CLK[clk]
        RST[rst_n]
        EN[i_enable]
        DUTY["i_duty[WIDTH-1:0]"]
    end

    subgraph pwm["pwm"]
        subgraph Counter["Period Counter"]
            CNT["Count 0 to MAX\nFree-running"]
        end

        subgraph Compare["Duty Compare"]
            CMP["counter < duty"]
        end

        subgraph Output_Logic["Output Logic"]
            OUT_L["PWM high when\ncounter < duty"]
        end
    end

    subgraph Outputs
        PWM_OUT[o_pwm]
    end

    CLK --> Counter
    RST --> Counter
    EN --> Counter
    DUTY --> Compare
    Counter --> Compare
    Compare --> Output_Logic
    Output_Logic --> PWM_OUT
